How to build a release:

From checked-out source directory...

First, setup environment variables:

	CVS_RSH=ssh; export CVS_RSH
	CVSROOT=:ext:esniper@cvs.esniper.sourceforge.net:/cvsroot/esniper
	export CVSROOT
	# change these to whatever is current
	MAJOR=2
	MINOR=3
	STEP=0
	PREV=2.2.0
	# these don't change
	CURRENT=$MAJOR.$MINOR.$STEP
	CURRFILE=esniper-$MAJOR-$MINOR-$STEP
	CURRTAG=Version_${MAJOR}_${MINOR}_${STEP}

Make sure automake dependencies are checked in in the correct date order.
Files listed in ascendng date order (oldest to newest).  Files on the same
line don't have to be the same time, just newer than the previous line and
older than the next:

	configure.in
	aclocal.m4 Makefile.am
	configure Makefile.in

Tag source:

	cvs tag -F $CURRTAG

Create a directory:

	mkdir $CURRENT

Copy Changes and Notes from the previous build:

	cp $PREV/Changes $PREV/Notes $CURRENT

Create source tar:

	cd $CURRENT
	mkdir $CURRFILE $CURRFILE/frontends
	cp ../aclocal.m4 ../auction.c ../auctionfile.c $CURRFILE
	cp ../auctionfile.h ../auction.h ../auctioninfo.c $CURRFILE
	cp ../auctioninfo.h ../AUTHORS ../buffer.c ../buffer.h $CURRFILE
	cp ../ChangeLog ../configure ../configure.in ../COPYING $CURRFILE
	cp ../depcomp ../esniper.1 ../esniper.c ../esniper.dsp $CURRFILE
	cp ../esniper.dsw ../esniper.h ../esniper.mak $CURRFILE
	cp ../esniper_man.html ../getopt.c ../getopt.h ../http.c $CURRFILE
	cp ../http.h ../INSTALL ../install-sh ../Makefile.am $CURRFILE
	cp ../Makefile.in ../misc.mk ../missing ../NEWS ../options.c $CURRFILE
	cp ../options.h ../README ../sample_auction.txt $CURRFILE
	cp ../sample_config.txt ../TODO ../util.c ../util.h $CURRFILE
	cp ../frontends/README ../frontends/snipe $CURRFILE/frontends
	tar cvf - $CURRFILE | gzip >$CURRFILE.tgz

Edit Changes and Notes (change version # for source file in Notes):

	vi Changes Notes

	(Changes can be just an edit of ../ChangeLog)

Build esniper on Sun, and HP and Cygwin, strip and copy to release directory:

	Sun:
		make
		strip esniper
		mv esniper $CURRENT/esniper-solaris-sparc

	Linux:
		cd esniper
		rcp sparky:esniper/\*.[ch] sparky:esniper/Makefile .
		# ensure Makefile has Sun dependencies turned off
		make clean all
		strip esniper
		rcp esniper sparky:esniper/$CURRENT/esniper-linux-x86
		CFLAGS="-static -O" make -e clean all
		strip esniper
		rcp esniper sparky:esniper/$CURRENT/esniper-linux-x86-static

	Cygwin:
		cd esniper
		rcp sparky:esniper/\*.[ch] sparky:esniper/Makefile .
		# ensure Makefile has Sun dependencies turned off
		make clean all
		strip esniper.exe
		rcp esniper.exe sparky:esniper/$CURRENT/esniper-cygwin.exe

	Windows:
		cd esniper
		# the following is in Visual Studio's VC98\Bin directory.
		vcvars32
		rcp sparky:esniper/*.[ch] sparky:esniper/esniper.mak .
		nmake /f esniper.mak
		rcp -b Release/esniper.exe sparky:esniper/$CURRENT/esniper.exe

	ftp upload.sourceforge.net -> anonymous
		cd incoming
		bin
		prompt
		mput esniper*
		put ../sample_auction.txt sample_auction.txt
		put ../sample_config.txt sample_config.txt
		put ../esniper.1 esniper.1
		put ../esniper_man.html esniper_man.html

Build other versions on sourceforge:

	scp $CURRFILE.tgz esniper@shell.sf.net:

	ssh -l esniper cf-shell.sourceforge.net
		<enter password>

	(note: list of hosts is in /etc/compilefarm-hosts)
	(note: makeit must be updated to run ./configure)

	FreeBSD:
		ssh x86-freebsd1
		(note: CURRFILE isn't defined, you must expand it yourself)
		(note: Cannot rely on CVS being up-to-date on internal systems)
		scp shell.sourceforge.net:$CURRFILE.tgz .
		gunzip <$CURRFILE.tgz | tar xvf -
		rm -rf esniper
		ln -s $CURRFILE esniper
		makeit
			<enter password>
		logout

	OS-X:
		ssh ppc-osx2
		makeit
			<enter password>
		logout

Then login to shell.sourceforge.net:

	ssh -l esniper shell.sourceforge.net
		<enter password>
	rm -f *.tgz
	mkdir $CURRENT
	mv esniper-* $CURRENT
	cd $CURRENT
	ftp upload
		(log in as anonymous)
		cd incoming
		bin
		prompt
		mput esniper*
	vi $PROJECT/htdocs/index.html
		change tgz file to current release (two places)

Go to www.sourceforge.net:
	- login
	- go to project
	- click on admin, then file releases, then add release
	- type in release number and click "create this release"
	- cut/paste notes and changes, ensure "preserve text" is selected
	- select files to import
	- mark each type (one at a time...)
	- click "send notice"

Send email to esniper-announce@lists.sourceforge.net to announce the
new version.

And you're done...
